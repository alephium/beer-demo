(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1538)}])},1538:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return er}});var r=t(5893),i=t(9008),c=t.n(i),o=t(7297),l=t(7294),s=t(5682),d=t(902),a=t(6371),u=t(4141),x=t(6656),h=t(9734);let f=()=>{let[e,n]=(0,l.useState)(),{data:t}=(0,h.ZP)("block-number",()=>x.web3.getCurrentNodeProvider().blockflow.getBlockflowChainInfo({fromGroup:d.w6.groupIndex,toGroup:d.w6.groupIndex}).then(e=>e.currentHeight),{refreshInterval:d.w6.pollingInterval});return(0,l.useEffect)(()=>{void 0!==t&&d.w6.electricity.fetchState().then(e=>n(e.fields.count))},[t]),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{style:{marginTop:"20px"},children:void 0!==e?(0,r.jsxs)("span",{style:{textAlign:"center",fontSize:"1.4rem"},children:["Electricity available: ",(0,a.formatUnits)(e.toString(),d.w6.countDecimals)," kWh"]}):null})})};var v=t(4077),m=t(1237),g=t(8046),p=t(300);function j(){let e=(0,o.Z)(["\n  display: flex;\n  justify-content: center;\n  margin-top: 20px;\n  height: 30px;\n"]);return j=function(){return e},e}function Z(){let e=(0,o.Z)(["\n  font-size: inherit;\n  display: flex;\n  font-family: 'Suisse BP Intl, sans-serif';\n"]);return Z=function(){return e},e}function w(){let e=(0,o.Z)(["\n  display: flex;\n  padding: 0 10px;\n  text-align: center;\n  font-weight: 600;\n  margin: 5px;\n"]);return w=function(){return e},e}let y=u.ZP.div(j()),b=(0,u.ZP)(p.Z)(Z()),E=u.ZP.text(w()),k=e=>{let{pageNumber:n,setPageNumber:t,numberOfElementsLoaded:i}=e,c=e=>{t("previous"===e?n-1:n+1)};return(0,r.jsxs)(y,{children:[(0,r.jsxs)(b,{disabled:1===n,onClick:()=>c("previous"),children:[(0,r.jsx)(m.Z,{}),(0,r.jsx)("span",{children:"Previous"})]}),(0,r.jsx)(E,{children:n}),(0,r.jsxs)(b,{disabled:void 0!==i&&i<15,onClick:()=>c("next"),children:[(0,r.jsx)("span",{children:"Next"}),(0,r.jsx)(g.Z,{})]})]})};var P=t(377),I=t(7906),C=t(295),N=t(3252),S=t(2882),_=t(3184),A=t(3816);function D(){let e=(0,o.Z)(["\n  text-decoration: underline;\n  cursor: pointer;\n"]);return D=function(){return e},e}let F=u.ZP.a(D()),B=e=>{let{to:n,children:t}=e;return(0,r.jsx)(F,{href:n,target:"_blank",children:t})};var T=t(629);function U(e){let{text:n,type:t}=e,i="devnet"===d.w6.network?"http://localhost:23000/".concat(t,"/").concat(n):"testnet"===d.w6.network?"https://explorer.testnet.alephium.org/".concat(t,"/").concat(n):"https://explorer.alephium.org/".concat(t,"/").concat(n);return(0,r.jsx)(B,{to:i,children:n.slice(0,8)+"..."+n.slice(-8)})}function z(e){let{event:n}=e;switch(n.name){case"ElectricityProduced":return(0,r.jsx)(l.Fragment,{children:(0,r.jsxs)(A.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,r.jsx)(N.Z,{align:"center",children:(0,r.jsx)(U,{text:n.txId,type:"transactions"})}),(0,r.jsx)(N.Z,{align:"center",children:(0,r.jsx)(U,{text:n.fields.from,type:"addresses"})}),(0,r.jsx)(N.Z,{align:"center",children:n.name}),(0,r.jsxs)(N.Z,{align:"center",children:[(0,a.formatUnits)(n.fields.num,d.w6.countDecimals)," kWh"]}),(0,r.jsx)(N.Z,{align:"center",children:"None"})]})});case"ElectricityConsumed":return(0,r.jsx)(l.Fragment,{children:(0,r.jsxs)(A.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,r.jsx)(N.Z,{align:"center",children:(0,r.jsx)(U,{text:n.txId,type:"transactions"})}),(0,r.jsx)(N.Z,{align:"center",children:(0,r.jsx)(U,{text:n.fields.to,type:"addresses"})}),(0,r.jsx)(N.Z,{align:"center",children:n.name}),(0,r.jsxs)(N.Z,{align:"center",children:[(0,a.formatUnits)(n.fields.num,d.w6.countDecimals)," kWh"]}),(0,r.jsxs)(N.Z,{align:"center",children:[(0,a.formatUnits)(n.fields.rewardAmount,18)," ",d.w6.tokenName]})]})});default:throw Error("unknown event")}}function W(e){let{events:n}=e;return(0,r.jsx)(S.Z,{component:T.Z,children:(0,r.jsxs)(I.Z,{children:[(0,r.jsx)(_.Z,{children:(0,r.jsxs)(A.Z,{children:[(0,r.jsx)(N.Z,{align:"center",children:"Tx Id"}),(0,r.jsx)(N.Z,{align:"center",children:"Caller Address"}),(0,r.jsx)(N.Z,{align:"center",children:"Event Type"}),(0,r.jsx)(N.Z,{align:"center",children:"Electricity"}),(0,r.jsx)(N.Z,{align:"center",children:"Reward"})]})}),(0,r.jsx)(C.Z,{children:n.map(e=>(0,r.jsx)(z,{event:e},e.txId))})]})})}function H(){let e=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: 20px;\n  width: 50%;\n"]);return H=function(){return e},e}async function O(e){let n=x.web3.getCurrentExplorerProvider();if(void 0===n)throw Error("no explorer provider specified");let t=d.w6.electricity.address,r=await n.contractEvents.getContractEventsContractAddressContractAddress(t,{page:e,limit:15});return r.map(e=>(function(e){let n=v.Cl.contract.eventsSig[e.eventIndex];if(void 0===e.fields||e.fields.length!==n.fieldNames.length){console.error("invalid event: ".concat(JSON.stringify(e)));return}let t=(0,x.fromApiVals)(e.fields,n.fieldNames,n.fieldTypes);return{txId:e.txHash,blockHash:e.blockHash,contractAddress:e.contractAddress,eventIndex:e.eventIndex,name:n.name,fields:t}})(e)).filter(e=>void 0!==e)}let G=()=>{let[e,n]=(0,l.useState)([]),[t,i]=(0,l.useState)(1),{enqueueSnackbar:c}=(0,P.Ds)();return(0,l.useEffect)(()=>{let e=async()=>{try{let e=await O(t);n(e)}catch(e){c("Failed to get events, error: ".concat(e),{persist:!0,variant:"error"})}};e();let r=setInterval(e,d.w6.pollingInterval);return()=>{clearInterval(r)}},[t,c]),(0,r.jsxs)(X,{children:[(0,r.jsx)(W,{events:e}),(0,r.jsx)(k,{pageNumber:t,setPageNumber:i,numberOfElementsLoaded:e.length})]})},X=u.ZP.div(H());function J(){let e=(0,o.Z)(["\n  margin-top: 10px;\n  width: 300px;\n  height: 40px;\n  font-size: 1.4rem;\n  ::placeholder {\n    font-size: 1.1rem;\n  }\n"]);return J=function(){return e},e}function L(){let e=(0,o.Z)(["\n  color: red;\n  font-size: 1.2rem\n"]);return L=function(){return e},e}function R(){let e=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return R=function(){return e},e}function V(){let e=(0,o.Z)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-bottom: 20px;\n"]);return V=function(){return e},e}function $(){let e=(0,o.Z)(["\n  margin-top: 10px;\n  margin-bottom: 10px;\n  height: 40px;\n  width: 310px;\n"]);return $=function(){return e},e}let q=1000n*10n**BigInt(d.w6.countDecimals),K=u.ZP.input(J()),M=u.ZP.div(L()),Q=u.ZP.div(R()),Y=u.ZP.div(V()),ee=u.ZP.button($());function en(e,n){let t;try{t=(0,a.parseUnits)(e,n).toBigInt()}catch(e){throw Error("invalid number")}if(t<=0n)throw Error("number must be greater than 0");if(t>q)throw Error("number must be less than 1000.0");return t}let et=()=>{let e=(0,s.Au)(),[n,t]=(0,l.useState)(),[i,c]=(0,l.useState)(),[o,a]=(0,l.useState)(),[u,x]=(0,l.useState)(),[h,v]=(0,l.useState)(),m=e=>{if(""===e){t(void 0),c(void 0),v(void 0);return}try{t(e),c(en(e,d.w6.countDecimals)),v(void 0)}catch(e){v("".concat(e))}},g=async e=>{if(""===e){a(void 0),x(void 0),v(void 0);return}try{a(e),x(en(e,d.w6.countDecimals)),v(void 0)}catch(e){v("".concat(e))}},p=()=>{void 0!==e.signerProvider&&void 0!==i&&(0,d.Uy)(e.signerProvider,i).then(e=>{c(void 0),t(void 0),console.log("produce tx id: ".concat(e.txId))})},j=()=>{var n;void 0!==e.signerProvider&&void 0!==u&&(null===(n=e.account)||void 0===n?void 0:n.address)!==void 0&&(0,d.F_)(e.signerProvider,u).then(e=>{x(void 0),a(void 0),console.log("consume tx id: ".concat(e.txId))})},Z=e.account&&void 0===h&&void 0!==i,w=e.account&&void 0===h&&void 0!==u;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(Q,{children:[(0,r.jsxs)(Y,{children:[(0,r.jsx)(K,{placeholder:"Enter a number",onChange:e=>m(e.target.value),value:void 0!==n?n:""}),(0,r.jsx)(ee,{onClick:p,disabled:!Z,children:"Produce Electricity (kWh)"}),(0,r.jsx)(K,{placeholder:"Enter a number",onChange:e=>g(e.target.value),value:void 0!==o?o:""}),(0,r.jsx)(ee,{onClick:j,disabled:!w,children:"Consume Electricity (kWh)"}),h&&(0,r.jsx)(M,{children:h}),(0,r.jsx)(f,{})]}),(0,r.jsx)(G,{})]})})};function er(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)(s.u$,{}),(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:"Electricity Demo"}),(0,r.jsx)("meta",{name:"description",content:"Electricity Demo"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(et,{})]})})}},8677:function(){},2808:function(){}},function(e){e.O(0,[509,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);